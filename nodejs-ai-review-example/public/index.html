<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AIä»£ç è¯„å®¡è°ƒè¯•å·¥å…·</title>
    <link rel="stylesheet" href="style.css">
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
</head>
<body>
    <div class="container">
        <header class="header">
            <h1>ğŸ¤– AIä»£ç è¯„å®¡è°ƒè¯•å·¥å…·</h1>
            <p>åŸºäºETRX CodeRevieweræ’ä»¶çš„é»˜è®¤é…ç½®</p>
        </header>

        <div class="main-content">
            <!-- å·¦ä¾§ï¼šæç¤ºè¯è¾“å…¥åŒºåŸŸ -->
            <div class="input-section">
                <div class="section-header">
                    <h2>ğŸ“ æç¤ºè¯é…ç½®</h2>
                    <div class="status-indicator">
                        <span id="connection-status" class="status-disconnected">æœªè¿æ¥</span>
                        <button id="test-connection" class="btn-small">æµ‹è¯•è¿æ¥</button>
                    </div>
                </div>

                <!-- æ¨¡æ¿é€‰æ‹©å™¨ -->
                <div class="form-group">
                    <label for="template-select">é€‰æ‹©æ¨¡æ¿:</label>
                    <select id="template-select" class="form-control">
                        <option value="default">ç®€æ´ä»£ç è¯„å®¡</option>
                        <option value="detailed">è¯¦ç»†ä»£ç è¯„å®¡</option>
                        <option value="backend">åç«¯ä»£ç è¯„å®¡</option>
                        <option value="frontend">å‰ç«¯ä»£ç è¯„å®¡</option>
                        <option value="doc">å¼€å‘æ‰‹å†Œè¯„å®¡</option>
                        <option value="custom">è‡ªå®šä¹‰æ¨¡æ¿</option>
                    </select>
                </div>

                <!-- æç¤ºè¯è¾“å…¥æ¡† -->
                <div class="form-group">
                    <label for="prompt-input">è¯„å®¡æç¤ºè¯:</label>
                    <textarea 
                        id="prompt-input" 
                        class="form-control prompt-textarea" 
                        placeholder="è¯·è¾“å…¥æˆ–é€‰æ‹©è¯„å®¡æç¤ºè¯æ¨¡æ¿..."
                        rows="15">
                    </textarea>
                    <div class="textarea-info">
                        <span id="char-count">0</span> å­—ç¬¦ | åŒ…å« <code>{code}</code> å ä½ç¬¦
                    </div>
                </div>

                <!-- æ“ä½œæŒ‰é’® -->
                <div class="button-group">
                    <button id="review-btn" class="btn-primary">
                        ğŸ” å¼€å§‹è¯„å®¡ç¤ºä¾‹ä»£ç 
                    </button>
                    <button id="clear-btn" class="btn-secondary">
                        ğŸ—‘ï¸ æ¸…é™¤ç»“æœ
                    </button>
                </div>

                <!-- ç¤ºä¾‹ä»£ç é¢„è§ˆ -->
                <div class="example-code">
                    <h3>ğŸ“„ ç¤ºä¾‹ä»£ç å˜æ›´</h3>
                    <div class="code-preview">
                        <div class="code-file">
                            <div class="file-header">user.js (ä¿®æ”¹)</div>
                            <div class="code-diff">
                                <div class="diff-removed">- function getUser(id) { return fetch('/api/user/' + id).then(r => r.json()); }</div>
                                <div class="diff-added">+ async function getUser(id) { if (!id) throw new Error('User ID is required'); try { const response = await fetch(`/api/user/${id}`); if (!response.ok) throw new Error(`HTTP error! status: ${response.status}`); return await response.json(); } catch (error) { console.error('Failed to fetch user:', error); throw error; } }</div>
                            </div>
                        </div>
                        <div class="code-file">
                            <div class="file-header">auth.js (æ–°å¢)</div>
                            <div class="code-diff">
                                <div class="diff-added">+ const jwt = require('jsonwebtoken'); function authenticateToken(req, res, next) { ... }</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- å³ä¾§ï¼šè¯„å®¡ç»“æœå±•ç¤ºåŒºåŸŸ -->
            <div class="result-section">
                <div class="section-header">
                    <h2>ğŸ“Š è¯„å®¡ç»“æœ</h2>
                    <div class="result-info">
                        <span id="result-status" class="result-pending">ç­‰å¾…è¯„å®¡</span>
                        <span id="result-time"></span>
                    </div>
                </div>

                <!-- åŠ è½½çŠ¶æ€ -->
                <div id="loading" class="loading hidden">
                    <div class="loading-spinner"></div>
                    <p>AIæ­£åœ¨è¯„å®¡ä»£ç ï¼Œè¯·ç¨å€™...</p>
                </div>

                <!-- é”™è¯¯çŠ¶æ€ -->
                <div id="error-display" class="error-display hidden">
                    <h3>âŒ è¯„å®¡å¤±è´¥</h3>
                    <p id="error-message"></p>
                </div>

                <!-- è¯„å®¡ç»“æœ -->
                <div id="result-display" class="result-display hidden">
                    <div class="result-meta">
                        <div class="meta-item">
                            <span class="meta-label">è¯„å®¡ID:</span>
                            <span id="review-id"></span>
                        </div>
                        <div class="meta-item">
                            <span class="meta-label">ä½¿ç”¨æ¨¡å‹:</span>
                            <span id="model-used"></span>
                        </div>
                        <div class="meta-item">
                            <span class="meta-label">è€—æ—¶:</span>
                            <span id="review-duration"></span>
                        </div>
                    </div>
                    
                    <div class="result-content">
                        <div id="markdown-content" class="markdown-body"></div>
                    </div>

                    <!-- å¤åˆ¶æŒ‰é’® -->
                    <div class="result-actions">
                        <button id="copy-result" class="btn-small">ğŸ“‹ å¤åˆ¶ç»“æœ</button>
                        <button id="copy-prompt" class="btn-small">ğŸ“ å¤åˆ¶æç¤ºè¯</button>
                    </div>
                </div>

                <!-- ç©ºçŠ¶æ€ -->
                <div id="empty-state" class="empty-state">
                    <div class="empty-icon">ğŸ¤–</div>
                    <h3>å‡†å¤‡å°±ç»ª</h3>
                    <p>é€‰æ‹©æˆ–è¾“å…¥æç¤ºè¯ï¼Œç„¶åç‚¹å‡»"å¼€å§‹è¯„å®¡"æŒ‰é’®</p>
                </div>
            </div>
        </div>
    </div>

    <script src="script.js"></script>
</body>
</html>