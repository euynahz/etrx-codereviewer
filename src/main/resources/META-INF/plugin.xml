<idea-plugin>
    <id>com.etrx.codereviewer</id>
    <name>ETRX Code Reviewer</name>
    <version>1.0.1</version>
    <vendor email="support@etrx.com" url="https://etrx.com">ETRX</vendor>

    <description><![CDATA[
      <p>AI-powered code review plugin for JetBrains IDEs.</p>
      <h2>Features</h2>
      <ul>
        <li>AI code review with customizable prompts</li>
        <li>Support for Ollama models (default: <code>qwen3:8b</code>) and OpenRouter</li>
        <li>Markdown result display</li>
        <li>Integration with VCS commit panel</li>
        <li>Configurable AI model settings</li>
      </ul>
    ]]></description>
    <change-notes><![CDATA[
      <h2>1.0.1 - Fixes</h2>
      <ul>
        <li>Compatibility Update: Updated the since-build to 231 and removed the upper bound (compatible with 231 and all subsequent platform versions).</li>
      </ul>
      <h2>1.0.0 - Initial release</h2>
      <ul>
        <li>AI-assisted review for selected code, all changes, and VCS commit panel integration</li>
        <li>Ollama and OpenRouter support with configurable model settings</li>
        <li>Markdown result rendering</li>
      </ul>
    ]]></change-notes>
    <idea-version since-build="231"/>

    <depends>com.intellij.modules.platform</depends>
    <depends>com.intellij.modules.vcs</depends>
    <depends>Git4Idea</depends>

    <resource-bundle>messages.CodeReviewerBundle</resource-bundle>

    <extensions defaultExtensionNs="com.intellij">
        <!-- Application Settings -->
        <applicationConfigurable 
            parentId="tools" 
            instance="com.etrx.codereviewer.ui.CodeReviewerConfigurable"
            id="com.etrx.codereviewer.settings"
            displayName="Code Reviewer"/>
        
        <!-- Application Service -->
        <applicationService 
            serviceImplementation="com.etrx.codereviewer.service.CodeReviewerSettingsService"/>
        
        
        <!-- Project Service -->
        <projectService 
            serviceImplementation="com.etrx.codereviewer.service.OllamaReviewService"/>
    </extensions>

    <actions>
        <!-- VCS Actions Group -->
        <group id="CodeReviewer.VcsActions" text="Code Reviewer" popup="true">
            <action 
                id="CodeReviewer.ReviewSelectedChanges"
                class="com.etrx.codereviewer.action.ReviewSelectedChangesAction"
                text="Review Selected Changes"
                description="Review selected changes with AI">
                <keyboard-shortcut keymap="$default" first-keystroke="ctrl alt R"/>
            </action>
            <action 
                id="CodeReviewer.ReviewAllChanges"
                class="com.etrx.codereviewer.action.ReviewAllChangesAction"
                text="Review All Changes"
                description="Review all changes with AI">
                <keyboard-shortcut keymap="$default" first-keystroke="ctrl alt shift R"/>
            </action>
            <add-to-group group-id="Vcs.Operations.Popup" anchor="after" relative-to-action="ChangesView.Diff"/>
        </group>

        <!-- Editor Context Menu -->
        <action 
            id="CodeReviewer.ReviewCode"
            class="com.etrx.codereviewer.action.ReviewCodeAction"
            text="Review Code with AI"
            description="Review selected code with AI">
            <add-to-group group-id="EditorPopupMenu" anchor="last"/>
        </action>

        <!-- VCS Commit Panel Action -->
        <action 
            id="CodeReviewer.VcsCommitReview"
            class="com.etrx.codereviewer.action.VcsCommitReviewAction"
            text="Review with AI"
            description="Review code changes with AI before committing"
            icon="AllIcons.Actions.Preview">
            <add-to-group group-id="Vcs.MessageActionGroup" anchor="first"/>
            <add-to-group group-id="Vcs.Operations.Popup" anchor="first"/>
        </action>
    </actions>

</idea-plugin>